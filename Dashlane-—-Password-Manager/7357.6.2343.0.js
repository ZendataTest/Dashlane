"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[7357],{702394:(e,t,i)=>{i.d(t,{Z:()=>u,h:()=>l});var a=i(696832),n=i(142897),r=i(159515),s=i(151796),o=i(201389),c=i(177704);const l=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:r}=(0,o.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:l,confirmDeleteDismiss:u,confirmDeleteConfirm:d}=i;return a.createElement(n.Vq,{title:l,onClose:e,isOpen:!0,dialogClassName:c.Ht,closeActionLabel:r("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:d,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:u,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}}},s)},u=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:c})=>{const{translate:l}=(0,o.Z)(),u=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:a,genericErrorTitle:n}=e;switch(t){case r.J.LastAdmin:return a;case r.J.GroupSharing:return i;case r.J.Generic:return n;default:return(0,s.U)(t)}})(t,e),d=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:a,genericErrorSubtitle:n}=e;switch(t){case r.J.LastAdmin:return a;case r.J.GroupSharing:return i;case r.J.Generic:return n;default:return(0,s.U)(t)}})(t,e);return a.createElement(n.Vq,{isOpen:!0,onClose:c,title:null!=u?u:"",closeActionLabel:l("_common_dialog_dismiss_button"),actions:e===r.J.LastAdmin?{primary:{children:t.lastAdminActionLabel,onClick:i}}:void 0},d)}},372814:(e,t,i)=>{i.d(t,{N:()=>o});var a=i(696832),n=i(661410),r=i(201389),s=i(508461);const o=({item:e,getSharing:t})=>{const{translate:i}=(0,r.Z)();if(!(e=>e&&(!e.sharingStatus.isShared||"admin"===e.sharingStatus.permission)&&!e.attachments.length)(e))return null;const o=t(e.id);return a.createElement(s.Z,{tooltipPlacement:"top-start",sharing:o,text:i("webapp_sharing_invite_share"),origin:n.Origin.ItemDetailView})}},159515:(e,t,i)=>{let a;i.d(t,{J:()=>a}),function(e){e[e.LastAdmin=0]="LastAdmin",e[e.GroupSharing=1]="GroupSharing",e[e.Generic=2]="Generic"}(a||(a={}))},104961:(e,t,i)=>{i.r(t),i.d(t,{NoteEditPanel:()=>Z});var a=i(696832),n=i(661410),r=i(66941),s=i(947843),o=i(62429),c=i(988799),l=i(635164),u=i(995445),d=i(133354),m=i(769569),g=i(604400),h=i(342573),p=i(453576),S=i(201389),_=i(60043),b=i(880706),C=i(234931),A=i(159515),E=i(372814),D=i(702394),f=i(796446),y=i(793071),N=i(885131),I=i(889483),w=i(97242),T=i(507525),v=i(396119),L=i(919663),G=i(925394);const{CONTENT:O,DOCUMENT_STORAGE:P,MORE_OPTIONS:F,SHARED_ACCESS:J}=C.SecureNoteTabs,k=e=>(0,y.A1)(e),R=(0,I.DP)((({lee:e,location:t,note:i,noteCategories:s,isShared:c,isAdmin:u,sharedAccessData:d})=>{var m;const{translate:g}=(0,S.Z)(),{routes:h}=(0,_.Xo)(),y=(0,L.aV)(),[I,R]=(0,a.useState)(O),[q,V]=(0,a.useState)(!1),[X]=(0,a.useState)(null),[U,Z]=(0,a.useState)(!1),[H,M]=(0,a.useState)(null),[B,x]=(0,a.useState)(!1),[$,z]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(!1),[W,Y]=(0,a.useState)(!1),[j,ee]=(0,a.useState)((()=>i.content)),[te,ie]=(0,a.useState)((()=>i.title)),ae=()=>{(0,v.P)(),t?.state?.entity?(0,b.d)({routes:h,location:t}):((0,o.Nc)(n.PageView.ItemSecureNoteList),(0,l.uX)(h.userSecureNotes))},ne=async(e=!0)=>{var t;z(!0);const a=null!=X?X:{spaceId:null!=(t=i.spaceId)?t:""};await r.C.updateSecureNote({content:j,title:te,id:i.id,attachments:[...i.attachments],...a}),z(!1),e?ae():(Y(!1),V(!1))},re=()=>{Q(!0)},se=async e=>{Q(!1),e.success&&(await r.C.commitSecureFile({secureFileInfo:e.secureFileInfo}),i.attachments.push((0,w.w)(e.secureFileInfo)),ne(!1))},oe=()=>M(null),ce=e=>M({reason:e}),le=()=>V(!0),ue=c,de=y||i.attachments.length>0,me=[O,F];ue?me.push(J):de&&me.push(P);const ge={confirmDeleteConfirm:g("webapp_secure_notes_edition_delete_confirm"),confirmDeleteDismiss:g("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:g("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:g("webapp_secure_notes_edition_delete_title"),lastAdminActionLabel:g("webapp_credential_edition_change_permissions"),lastAdminTitle:g("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:g("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:g("webapp_secure_notes_edition_group_sharing_title"),groupSharingSubtitle:g("webapp_credential_edition_group_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"},he={attachments:i.attachments,category:i.category?i.category.id:"noCategory",content:i.content,id:i.id,limitedPermissions:c&&!u,secured:i.secured,spaceId:i.spaceId,title:i.title,type:i.color},pe=c?d.users.length+d.groups.length:0;return a.createElement(f.zI,{isViewingExistingItem:!0,itemHasBeenEdited:q,onSubmit:()=>{ne()},submitPending:$,secondaryActions:(()=>{switch(I){case O:return[m||(m=a.createElement(E.N,{item:i,getSharing:k,key:"shareaction"}))];case P:return[a.createElement(T.d,{isQuotaReached:!1,onFileUploadStarted:re,onFileUploadDone:se,isShared:c,itemId:i.id,key:"uploadAction",dataType:"KWSecureNote"})];default:return[]}})(),onNavigateOut:ae,onClickDelete:()=>{if(c){if(d.groups.length>0)return void ce(A.J.GroupSharing);if(d.isLastAdmin)return void ce(A.J.LastAdmin)}Z(!0)},ignoreCloseOnEscape:U||B,isSomeDialogOpen:!!H,formId:"edit_securenote_panel",header:a.createElement(G.h,{activeTab:I,backgroundColor:he.type,displayDocumentStorage:me.includes(P),displaySharedAccess:me.includes(J),recipientsCount:pe,setActiveTab:R,disabled:c&&!u,title:te,setTitle:e=>{le(),ie(e)}})},a.createElement(N.T,{activeTab:I,data:he,content:j,setContent:ee,handleFileInfoDetached:e=>{i.attachments=i.attachments.filter((t=>t.id!==e)),ne(!1)},hasAttachment:i.attachments.length>0,isAdmin:u,isSecureNoteAttachmentEnabled:y,isShared:c,isUploading:K,isEditing:W,setIsEditing:Y,lee:e,noteCategories:s.items,onModifyData:le,onModalDisplayStateChange:x,saveSecureNoteOptions:e=>{const{category:t,spaceId:a,type:n,secured:s}=e;r.C.updateSecureNote({id:i.id,spaceId:null!=a?a:"",type:n,category:t,secured:s})}}),U&&a.createElement(D.h,{closeConfirmDeleteDialog:()=>Z(!1),onDeleteConfirm:async()=>{i.attachments.forEach((async e=>{const{id:t}=e;await r.C.deleteSecureFile({id:t})}));const e=await r.C.deleteSecureNote({id:i.id});e.success?(0,l.uX)(h.userSecureNotes):e.error.code===p.DeleteSecureNoteErrorCode.LEAVE_SHARING_FORBIDDEN_GROUP_ITEM?ce(A.J.GroupSharing):e.error.code===p.DeleteSecureNoteErrorCode.LEAVE_SHARING_FORBIDDEN_LAST_ADMIN?ce(A.J.LastAdmin):ce(A.J.Generic)},translations:ge}),H&&a.createElement(D.Z,{reason:H.reason,translations:ge,goToSharingAccess:()=>{oe(),R(C.SecureNoteTabs.SHARED_ACCESS)},closeCantDeleteDialog:oe}))})),q=e=>{const{note:t}=e,{getPermissionForItem:i,getSharingStatusForItem:n}=(0,u.Y)(m.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}}},[]),r=!!n.data?.isShared,s=r&&i.data?.permission===g.y3.Admin,o=(0,h.r)(t.id,!!s);return i.status===d.rq.Loading||n.status===d.rq.Loading?null:a.createElement(R,{...e,isShared:r,isAdmin:s,sharedAccessData:o})},V=e=>{if(!e.match.params)throw new Error("missing route `params`");return`{${e.match.params.uuid}}`},X={note:{live:r.C.liveNote,liveParam:V,query:r.C.getNote,queryParam:V},noteCategories:{query:r.C.getNoteCategories}},U={strategies:X},Z=(0,s.$)((0,c.i)((e=>{const{note:t}=e,{routes:i}=(0,l.Xo)(),r=a.useCallback((()=>!t&&((0,l.uX)(i.userSecureNotes),!0)),[t,i.userSecureNotes]);return a.useEffect((()=>{r()||(0,o.Nc)(n.PageView.ItemSecureNoteDetails)}),[r]),a.useEffect((()=>{r()}),[r,t]),t?a.createElement(q,{...e}):null}),U),X)},880706:(e,t,i)=>{i.d(t,{d:()=>r});var a=i(528144),n=i(635164);const r=({routes:e,location:t})=>{t?.state?.entity?(0,a.yy)(t?.state?.entity)?(0,n.uX)(e.userSharingGroupInfo(t?.state?.entity?.groupId)):(0,n.uX)(e.userSharingUserInfo(t?.state?.entity?.alias)):(0,n.uX)(e.userSharingCenter)}}}]);