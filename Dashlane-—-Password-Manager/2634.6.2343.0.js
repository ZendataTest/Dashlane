"use strict";(globalThis.webpackChunk_dashlane_leeloo=globalThis.webpackChunk_dashlane_leeloo||[]).push([[2634],{368021:(e,t,a)=>{a.r(t),a.d(t,{CredentialAddPanel:()=>q}),a(461238);var i=a(526849),n=a(66941),s=a(947843),o=a(988799),r=a(696832),l=a(661410),c=a(441217),d=a(453576),u=a(112555),m=a(482598),p=a(299074),g=a(96862),w=a(385441),C=a(201389),h=a(787268),S=a(62429),I=a(676849),y=a(635164),v=a(352116),P=a(796446),b=a(169600),f=a(819978),k=a(142897),E=a(383849),V=a.n(E);const _=()=>{const{translate:e}=(0,C.Z)();return(0,k.tZ)(P.V9,{icon:(0,k.tZ)("div",{className:V()("icon--gEZfcCvjSg","dummyIcon--ix6eIwyFEN")}),title:e("webapp_credential_addition_website")})};var T;const A=["name","website"],N={name:"title",website:"url"};var U=a(889483);const O=()=>({filterToken:{filterCriteria:[]},sortToken:{sortCriteria:[],uniqField:"id"}}),D={live:n.C.liveCredentialsCount,liveParam:(0,i.compose)(btoa,JSON.stringify,O),query:n.C.getCredentialsCount,queryParam:O},L={activeSpaces:{query:n.C.getActiveSpaces},credentialsCount:D},B={strategies:L},W=(0,U.DP)((({activeSpaces:e,onClose:t,protectedItemsUnlockerShown:a,openProtectedItemsUnlocker:s,areProtectedItemsUnlocked:o})=>{var k,E;const V=(0,r.createRef)(),[U,O]=(0,r.useState)(!1),{routes:D}=(0,y.Xo)(),{currentSpaceId:L}=(0,v.fV)(),B=(0,h.V)(),{translate:W}=(0,C.Z)(),{wrap:q}=(0,u.u)(),R=(0,I.v0)(),Z=!R.isLoading&&R.shouldShowAtOrOverLimitContent,{createCollection:F,updateCollection:M}=(0,m.u)(p.v),{addItemToCollections:H}=(0,m.u)(w.a),[K,X]=(0,r.useState)(!1),[x,j]=r.useState(!1),z=(0,y.TH)(),G=(0,r.useRef)(z.state?.previouslyGeneratedPassword),[J,$]=(0,r.useState)(Boolean(G.current)),Q={autoLogin:!0,autoProtected:!1,category:"",email:"",login:"",note:"",onlyForThisSubdomain:!1,password:"",protectWithMasterPassword:!1,secondaryLogin:"",spaceId:L,subdomainOnly:!1,title:"",url:"",linkedWebsites:{addedByDashlane:[],addedByUser:[]},otpSecret:"",otpUrl:""},Y={id:"",limitedPermissions:!1,type:"KWAuthentifiant"},ee=(()=>{const e=(0,y.CN)();return A.reduce(((t,a)=>(t[N[a]||a]=e.get(a),t)),{})})(),te={...Q,...{...ee,url:null!=(k=z.state?.website)?k:ee.url,password:null!=(E=G.current)?E:""}},[ae,ie]=r.useState(te);(0,r.useEffect)((()=>{const e=!(0,i.equals)(ae,te);$(e)}),[ae]);const ne=()=>{X(!0)},se=()=>{(0,S.Nc)(l.PageView.ItemCredentialList),K?(0,y.uX)(D.userCredentials):t?t():(0,y.uX)(D.userCredentials)};return r.useEffect((()=>{Z&&ne(),(0,S.Nc)(l.PageView.ItemCredentialCreate)}),[Z]),r.createElement(P.zI,{isViewingExistingItem:!1,isSomeDialogOpen:x,itemHasBeenEdited:J,onSubmit:async()=>{Boolean(V.current?.isFormValid())&&(O(!0),await(async e=>{const t=V.current?.getVaultItemCollections(),a={kwType:"KWAuthentifiant",origin:d.SaveOrigin.MANUAL,content:e,shouldSkipSync:t?.some((e=>e.isShared))},i=await n.C.savePersonalDataItem(a);i.success&&t?.length&&await q((()=>(async(e,t)=>{const a=[];for(const i of t)i.isShared?a.push(i.id):(i.vaultItems=[{id:e,type:d.DataModelType.KWAuthentifiant}],i.id?await M({id:i.id,collection:i,operationType:g.C.APPEND_VAULT_ITEMS}):await F({content:i}));a.length&&await H({collectionIds:a,itemId:e})})(i.itemId,t)),(()=>{B.showAlert(W("_common_generic_error"),c.BLW.ERROR)}))()})({...ae,...Y}),Z?ne():se())},onNavigateOut:se,formId:"add_credential_panel",header:T||(T=r.createElement(_,null)),submitPending:U},r.createElement(b.S,{ref:V,editableValues:ae,setEditableValues:ie,readonlyValues:Y,isNewItem:!0,signalEditedValues:()=>$(!0),additionalProps:{activeSpaces:e,areProtectedItemsUnlocked:o,openProtectedItemsUnlocker:s,protectedItemsUnlockerShown:a,setHasOpenedDialogs:j}}),K&&r.createElement(f.e,{isVisible:K,handleDismiss:se}))})),q=(0,s.$)((0,o.i)(W,B),L)}}]);